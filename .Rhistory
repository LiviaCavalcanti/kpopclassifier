knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
theme_set(theme_bw())
# library(broom)
library(modelr)
library(corrplot)
install.packages('broom')
install.packages("broom")
install.packages('corrplot')
install.packages('gridExtra')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
theme_set(theme_bw())
library(broom)
library(modelr)
library(corrplot)
library(gridExtra)
song_features = read_csv(here::here("data/new_song_features.csv"))
artist_followers = read_csv(here::here("data/artists_name_and_followers.csv"))
summary(song_features)
glimpse(artist_followers)
song_artist_data = inner_join(artist_followers, song_features)
temp=song_artist_data %>% select(-isKPop, -isExplicit, -albumName, -song_name, -artist_name, -release_date)
m=cor(temp)
corrplot(m, method="color")
kpop = song_artist_data %>% filter(isKPop=="True") %>% select(-instrumentalness, -isKPop, -isExplicit) #intrumentalness ~ 0, isExplicit == FALSE
kpop_cor = kpop %>% select(-artist_name, -albumName, -song_name, -release_date)
kpop_cor = cor(kpop_cor)
corrplot(kpop_cor, method="color")
View(kpop)
kpop = song_artist_data %>% filter(isKPop=="True") %>% select(-instrumentalness, -isKPop, -isExplicit) #intrumentalness ~ 0, isExplicit == FALSE
kpop_cor = kpop %>% select(-artist_name, -albumName, -song_name, -release_date)
kpop_cor = cor(kpop_cor)
corrplot(kpop_cor, method="color")
View(kpop)
View(kpop)
View(song_artist_data)
kpop = song_artist_data %>% filter(isKPop=="TRUE") %>% select(-instrumentalness, -isKPop, -isExplicit) #intrumentalness ~ 0, isExplicit == FALSE
kpop_cor = kpop %>% select(-artist_name, -albumName, -song_name, -release_date)
kpop_cor = cor(kpop_cor)
corrplot(kpop_cor, method="color")
apop = song_artist_data %>% filter(isKPop=="FALSE") %>% select(-isKPop)
apop_cor = apop %>% select(-artist_name, -albumName, -song_name, -release_date, -isExplicit)
apop_cor = cor(apop_cor)
corrplot(apop_cor, method="color")
plots <- function(song_data) {
dance<-song_data %>%
ggplot() +
geom_density(aes(danceability))
tempo<-song_data %>%
ggplot() +
geom_density(aes(tempo))
pop<-song_data %>%
ggplot() +
geom_density(aes(popularity))
totArt <- song_data %>%
ggplot() +
geom_density(aes(totalArtists))
totalTrack<-song_data %>%
ggplot() +
geom_density(aes(albumTotalTracks))
energy<-song_data %>%
ggplot() +
geom_density(aes(energy))
speech<-song_data %>%
ggplot() +
geom_density(aes(speechiness))
acoustic <- song_data %>%
ggplot() +
geom_density(aes(acousticness))
# song_data %>%
#   ggplot() +
#   geom_density(aes(instrumentalness))
live <- song_data %>%
ggplot() +
geom_density(aes(liveness))
val <- song_data %>%
ggplot() +
geom_density(aes(valence))
dur <- song_data %>%
ggplot() +
geom_density(aes(duration_ms)) +
theme(axis.text.x = element_text(angle=90))
grid.arrange(dance, tempo, pop, totArt, totalTrack, energy, speech, acoustic, live, val, dur, nrow = 3)
}
plots(apop)
plots(kpop)
View(kpop)
View(kpop)
kpop %>% ggplot(aes(x=followers, y = popularity)) + geom_point()
kpop %>% ggplot(aes(x=followers, y = popularity)) + geom_point() + scale_x_log10()
kpop %>% ggplot(aes(x=followers, y = popularity)) + geom_point() + scale_x_log10() + scale_y_log10()
kpop %>% ggplot(aes(x=followers, y = popularity)) + geom_point()
kpop %>% ggplot(aes(x=popularity, y = duration_ms)) + geom_point()
kpop %>% ggplot(aes(x=popularity, y = duration_ms)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
modelo_duration <- lm(popularity ~ duration_ms ,
data = kpop)
tidy(modelo_duration)
glance(modelo_duration)
tidy(modelo_duration)
glance(modelo_duration)
tidy(modelo_duration)
tidy(modelo_duration)
glance(modelo_duration)
glance(modelo_duration)
apop %>% ggplot(aes(x=popularity, y = duration_ms)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
modelo_duration_apop <- lm(popularity ~ duration_ms ,
data = apop)
tidy(modelo_duration_apop)
glance(modelo_duration_apop)
kpop %>% ggplot(aes(x=popularity, y = acousticness)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
modelo_acousticness <- lm(popularity ~ acousticness ,
data = kpop)
tidy(modelo_acousticness)
glance(modelo_acousticness)
acousticness
acousticness
View(apop)
apop %>% ggplot(aes(x=popularity, y = acousticness)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
modelo_acousticness_apop <- lm(popularity ~ acousticness ,
data = apop)
tidy(modelo_acousticness_apop)
glance(modelo_acousticness_apop)
